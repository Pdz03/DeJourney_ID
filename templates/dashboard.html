<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />

    <title>DeJourney ID</title>
    <meta content="" name="description" />
    <meta content="" name="keywords" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Roboto:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Work+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet"
    />

    <!-- Vendor CSS Files -->
    <link
      href="{{ url_for('static', filename='vendor/bootstrap-icons/bootstrap-icons.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='vendor/fontawesome-free/css/all.min.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='vendor/aos/aos.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='vendor/glightbox/css/glightbox.min.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='vendor/swiper/swiper-bundle.min.css') }}"
      rel="stylesheet"
    />

    <!-- Template Main CSS File -->

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />

    <link
      href="{{ url_for('static', filename='css/main.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='css/style.css') }}"
      rel="stylesheet"
    />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>

    <script>
      $(document).ready(function () {
        get_postlist();
      });

      function get_postlist() {
        $("#postlist").empty();
        $.ajax({
          type: "GET",
          url: "/list_post",
          data: {},
          success: function (response) {
            if (response["result"] == "success") {
              let postlist = response["posts"];
              for (let i = 0; i < postlist.length; i++) {
                let post = postlist[i];
                console.log(post);
                let status = "";
                if (post["confirm"] === 0) {
                  status = `
                    <button type="button" onclick="terimapost('${post["postid"]}')">Terima</button>
                    <button type="button" onclick="tolakpost('${post["postid"]}')">Tolak</button>
                    `;
                } else {
                  if (post["confirm"] === 1) {
                    status = "Diterima";
                  } else if (post["confirm"] === 2) {
                    status = "Ditolak";
                  }
                }
                let temp_post = `
                <tr>
                <td>${post["judul"]}</td>
                <td>${status}</td>
                </tr>
                `;
                $("#postlist").append(temp_post);
              }
            }
          },
        });
      }

      function terimapost(postid) {
        let type = 1;
        console.log(postid, type);

        $.ajax({
          type: "POST",
          url: "/confirm_post",
          data: {
            id_give: postid,
            type_give: type,
          },
          success: function (response) {
            if (response["result"] === "success") {
              get_postlist();
            }
          },
        });
      }

      function tolakpost(postid) {
        let type = 2;
        console.log(postid, type);

        $.ajax({
          type: "POST",
          url: "/confirm_post",
          data: {
            id_give: postid,
            type_give: type,
          },
          success: function (response) {
            if (response["result"] === "success") {
              get_postlist();
            }
          },
        });
      }

      function openuser() {
        $("#kelolauser").removeClass("visually-hidden");
        $("#kelolapost").addClass("visually-hidden");
        $("#btn-user").addClass("active");
        $("#btn-post").removeClass("active");
      }

      function openpost() {
        $("#kelolapost").removeClass("visually-hidden");
        $("#kelolauser").addClass("visually-hidden");
        $("#btn-post").addClass("active");
        $("#btn-user").removeClass("active");
      }
    </script>
  </head>

  <body>
    <!-- ======= Header ======= -->
    <header id="header" class="header d-flex align-items-center">
      <div
        class="container-fluid container-xl d-flex align-items-center justify-content-between"
      >
        <a href="/" class="logo d-flex align-items-center">
          <h1 style="color: greenyellow">DeJourney ID</h1>
          <span style="color: aliceblue">.</span>
        </a>

        <i class="mobile-nav-toggle mobile-nav-show bi bi-list"></i>
        <i class="mobile-nav-toggle mobile-nav-hide d-none bi bi-x"></i>
        <nav id="navbar" class="navbar"></nav>
        <!-- .navbar -->
      </div>
    </header>
    <!-- End Header -->

    <main id="main">
      <!-- ======= Breadcrumbs ======= -->
      <div
        class="breadcrumbs d-flex align-items-center"
        style="background-image: url('{{ url_for('static', filename='img/content-bg.jpg') }}');"
      >
        <div
          class="container position-relative d-flex flex-column align-items-center"
          data-aos="fade"
        ></div>
      </div>
      <!-- End Breadcrumbs -->

      <!-- ======= Get Started Section ======= -->

      <!-- ======= Blog Section ======= -->
      <div class="container" data-aos="fade-up" data-aos-delay="100">
        <section style="background-color: #eee">
          <h3>DASHBOARD ADMIN</h3>
          <hr />
          <div class="text-center">
            <button
              class="btn btn-secondary active"
              id="btn-post"
              onclick="openpost()"
            >
              Data postingan
            </button>
            <button
              class="btn btn-secondary"
              id="btn-user"
              onclick="openuser()"
            >
              Data user
            </button>
          </div>
          <div id="kelolapost">
            <h5>Data Postingan</h5>
            <table
              id="tablepost"
              class="table table-striped"
              style="width: 100%"
            >
              <thead>
                <tr>
                  <th>Postingan</th>
                  <th>Aksi</th>
                </tr>
              </thead>
              <tbody id="postlist"></tbody>
            </table>
          </div>
          <div id="kelolauser" class="visually-hidden">
            <h5>Data User</h5>
            <table
              id="tablepost"
              class="table table-striped"
              style="width: 100%"
            >
              <thead>
                <tr>
                  <th>Postingan</th>
                  <th>Aksi</th>
                </tr>
              </thead>
              <tbody id="postlist"></tbody>
            </table>
          </div>
        </section>
      </div>
      <!-- End Blog Section -->
    </main>
    <!-- End #main -->

    <!-- ======= Footer ======= -->
    <br /><br /><br /><br /><br />
    <footer id="footer" class="footer">
      <div class="footer-legal text-center position-relative">
        <div class="container">
          <div class="copyright">
            &copy; Copyright <strong><span>Kelompok 2</span></strong
            >. All Rights Reserved
          </div>
        </div>
      </div>
    </footer>
    <!-- End Footer -->

    <a
      href="#"
      class="scroll-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

    <div id="preloader"></div>

    <!-- Vendor JS Files -->
    <!-- <script
 src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
 integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
 crossorigin="anonymous"
></script> -->

    <script src="{{ url_for('static', filename='vendor/bootstrap/js/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='vendor/aos/aos.js') }}"></script>
    <script src="{{ url_for('static', filename='vendor/glightbox/js/glightbox.min.js') }}"></script>
    <script src="{{ url_for('static', filename='vendor/isotope-layout/isotope.pkgd.min.js') }}"></script>
    <script src="{{ url_for('static', filename='vendor/swiper/swiper-bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='vendor/purecounter/purecounter_vanilla.js') }}"></script>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/navbar-control.js') }}"></script>
    <script src="{{ url_for('static', filename='js/user-control.js') }}"></script>
  </body>
</html>
